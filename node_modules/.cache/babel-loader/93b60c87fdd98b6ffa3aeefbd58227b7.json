{"ast":null,"code":"var _jsxFileName = \"/Users/pedroleridanieto/Desktop/game_trabajo_final /chat-firebase/src/views/ChatScreen.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect, useRef } from \"react\";\nimport { AddCircle, CreditCard, Gif, EmojiEmotions } from \"@material-ui/icons\";\nimport EncabezadoChat from \"../components/EncabezadoChat\";\nimport Mensaje from \"../components/Mensaje\";\nimport firebaseApp from \"../firebase/credenciales\";\nimport { getFirestore, doc, setDoc, collection, getDocs } from \"firebase/firestore\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst firestore = getFirestore(firebaseApp);\n\nfunction ChatScreen(_ref) {\n  _s();\n\n  let {\n    canalActivo,\n    usuario\n  } = _ref;\n  const [inputMensaje, setInputMensaje] = useState(\"\");\n  const [listaMensajes, setListaMensajes] = useState([]);\n  const anchor = useRef();\n\n  function filtrarContenido(textoOriginal) {\n    const noOK = [\"tonto\", \"hdp\", \"mk\"];\n    const array = textoOriginal.split(\" \");\n    array.forEach((palabra, index) => {\n      if (noOK.includes(palabra)) {\n        array[index] = \"****\";\n      }\n    });\n    return array.join(\" \");\n  }\n\n  function enviarMensaje(e) {\n    e.preventDefault();\n    const docuRef = doc(firestore, `canales/${canalActivo}/mensajes/${new Date().getTime()}`);\n    const mensajeFiltrado = filtrarContenido(inputMensaje);\n    setDoc(docuRef, {\n      foto: usuario.photoURL,\n      usuario: usuario.displayName,\n      mensaje: mensajeFiltrado,\n      id: new Date().getTime()\n    });\n    setInputMensaje(\"\");\n    getListaMensajes();\n    anchor.current.scrollIntoView({\n      behavior: \"smooth\"\n    });\n  }\n\n  async function getListaMensajes() {\n    const mensajesArr = [];\n    const coleccionRef = collection(firestore, `canales/${canalActivo}/mensajes`);\n    const mensajesJeroglificos = await getDocs(coleccionRef);\n    mensajesJeroglificos.forEach(mensaje => {\n      mensajesArr.push(mensaje.data());\n    });\n    setListaMensajes([...mensajesArr]);\n  }\n\n  useEffect(() => {\n    getListaMensajes();\n  }, [canalActivo]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"chat\",\n    children: [/*#__PURE__*/_jsxDEV(EncabezadoChat, {\n      nombreCanal: canalActivo\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chat__messages\",\n      children: [listaMensajes ? listaMensajes.map(mensaje => {\n        return /*#__PURE__*/_jsxDEV(Mensaje, {\n          mensajeFirebase: mensaje\n        }, mensaje.id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 83,\n          columnNumber: 22\n        }, this);\n      }) : null, /*#__PURE__*/_jsxDEV(\"div\", {\n        ref: anchor,\n        style: {\n          marginBottom: \"75px\"\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chat__input\",\n      children: /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: enviarMensaje,\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          disabled: canalActivo ? false : true,\n          value: inputMensaje,\n          onChange: e => setInputMensaje(e.target.value),\n          placeholder: `Enviar mensaje a # ${canalActivo || \"\"}`\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 91,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          disabled: canalActivo ? false : true,\n          className: \"chat__inputButton\",\n          type: \"submit\",\n          children: \"Enviar Mensaje\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 98,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 77,\n    columnNumber: 5\n  }, this);\n}\n\n_s(ChatScreen, \"UYEdCYw48KZ247CRv7z3iy5BFaI=\");\n\n_c = ChatScreen;\nexport default ChatScreen;\n\nvar _c;\n\n$RefreshReg$(_c, \"ChatScreen\");","map":{"version":3,"names":["React","useState","useEffect","useRef","AddCircle","CreditCard","Gif","EmojiEmotions","EncabezadoChat","Mensaje","firebaseApp","getFirestore","doc","setDoc","collection","getDocs","firestore","ChatScreen","canalActivo","usuario","inputMensaje","setInputMensaje","listaMensajes","setListaMensajes","anchor","filtrarContenido","textoOriginal","noOK","array","split","forEach","palabra","index","includes","join","enviarMensaje","e","preventDefault","docuRef","Date","getTime","mensajeFiltrado","foto","photoURL","displayName","mensaje","id","getListaMensajes","current","scrollIntoView","behavior","mensajesArr","coleccionRef","mensajesJeroglificos","push","data","map","marginBottom","target","value"],"sources":["/Users/pedroleridanieto/Desktop/game_trabajo_final /chat-firebase/src/views/ChatScreen.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from \"react\";\n\nimport { AddCircle, CreditCard, Gif, EmojiEmotions } from \"@material-ui/icons\";\nimport EncabezadoChat from \"../components/EncabezadoChat\";\nimport Mensaje from \"../components/Mensaje\";\n\nimport firebaseApp from \"../firebase/credenciales\";\nimport {\n  getFirestore,\n  doc,\n  setDoc,\n  collection,\n  getDocs,\n} from \"firebase/firestore\";\nconst firestore = getFirestore(firebaseApp);\n\nfunction ChatScreen({ canalActivo, usuario }) {\n  const [inputMensaje, setInputMensaje] = useState(\"\");\n  const [listaMensajes, setListaMensajes] = useState([]);\n\n  const anchor = useRef();\n\n  function filtrarContenido(textoOriginal) {\n    const noOK = [\"tonto\", \"hdp\", \"mk\"];\n\n    const array = textoOriginal.split(\" \");\n    array.forEach((palabra, index) => {\n      if (noOK.includes(palabra)) {\n        array[index] = \"****\";\n      }\n    });\n\n    return array.join(\" \");\n  }\n\n  function enviarMensaje(e) {\n    e.preventDefault();\n    const docuRef = doc(\n      firestore,\n      `canales/${canalActivo}/mensajes/${new Date().getTime()}`\n    );\n\n    const mensajeFiltrado = filtrarContenido(inputMensaje);\n\n    setDoc(docuRef, {\n      foto: usuario.photoURL,\n      usuario: usuario.displayName,\n      mensaje: mensajeFiltrado,\n      id: new Date().getTime(),\n    });\n\n    setInputMensaje(\"\");\n    getListaMensajes();\n    anchor.current.scrollIntoView({ behavior: \"smooth\" });\n  }\n\n  async function getListaMensajes() {\n    const mensajesArr = [];\n\n    const coleccionRef = collection(\n      firestore,\n      `canales/${canalActivo}/mensajes`\n    );\n    const mensajesJeroglificos = await getDocs(coleccionRef);\n    mensajesJeroglificos.forEach((mensaje) => {\n      mensajesArr.push(mensaje.data());\n    });\n\n    setListaMensajes([...mensajesArr]);\n  }\n\n  useEffect(() => {\n    getListaMensajes();\n  }, [canalActivo]);\n\n  return (\n    <div className=\"chat\">\n      <EncabezadoChat nombreCanal={canalActivo} />\n\n      <div className=\"chat__messages\">\n        {listaMensajes\n          ? listaMensajes.map((mensaje) => {\n              return <Mensaje mensajeFirebase={mensaje} key={mensaje.id} />;\n            })\n          : null}\n        <div ref={anchor} style={{ marginBottom: \"75px\" }}></div>\n      </div>\n\n      <div className=\"chat__input\">\n        <form onSubmit={enviarMensaje}>\n          <input\n            type=\"text\"\n            disabled={canalActivo ? false : true}\n            value={inputMensaje}\n            onChange={(e) => setInputMensaje(e.target.value)}\n            placeholder={`Enviar mensaje a # ${canalActivo || \"\"}`}\n          />\n          <button\n            disabled={canalActivo ? false : true}\n            className=\"chat__inputButton\"\n            type=\"submit\"\n          >\n            Enviar Mensaje\n          </button>\n        </form>\n      </div>\n    </div>\n  );\n}\n\nexport default ChatScreen;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}